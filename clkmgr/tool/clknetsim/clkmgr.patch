From fb1017379bf602eef46c5b35924a120d28c8938f Mon Sep 17 00:00:00 2001
From: Erez Geva <ErezGeva2@gmail.com>
Date: Sat, 14 Jun 2025 19:51:13 +0200
Subject: [PATCH 3/3] Add clkmgr_proxy

---
 clknetsim.bash | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

diff --git a/clknetsim.bash b/clknetsim.bash
index 5a55b1f..7d6acde 100644
--- a/clknetsim.bash
+++ b/clknetsim.bash
@@ -88,6 +88,26 @@ start_client() {
 	    args=($opts)
 	    while read line; do args+=("$line"); done <<< "$config"
 	    ;;
+	clkmgr_proxy)
+	    local -a cfgA=(${config//;/ })
+	    cat > $CLKNETSIM_TMPDIR/conf.$node <<-EOF
+		{
+		  "timeBases": [{
+		    "timeBaseName": "Global Clock",
+		    "ptp4l": {
+		      "interfaceName": "${cfgA[2]}",
+		      "udsAddr": "/clknetsim/unix/${cfgA[0]}:1",
+		      "domainNumber": 0,
+		      "transportSpecific": 1
+		    },
+		    "chrony": { "udsAddr": "/clknetsim/unix/${cfgA[1]}:1" }
+		  }]
+		}
+		EOF
+	    args=(-f $CLKNETSIM_TMPDIR/conf.$node $opts)
+	    ;;
+	clkmgr)
+	    ;;
 	*)
 	    echo "unknown client $client"
 	    exit 1
-- 
2.39.5

